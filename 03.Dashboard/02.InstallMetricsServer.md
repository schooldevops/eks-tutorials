# Metrics 서버 설치

[Kubernetes Metrics Server](https://docs.aws.amazon.com/eks/latest/userguide/metrics-server.html)

- Kubernetes Metrics Server 는 클러스터의 리소스 사용정보를 수집한다. 
- 기본적으로 EKS 클러스터에 설치 되지는 않는다. 
- 쿠버네티스 add on 으로 사용된다. 

## Metrics Server가 제공하는 것

- 대부분 클러스터에서 동작하는 단일 배포판
- 빠른 오토 스케일링, 매 15초 간격으로 메트릭을 수집한다.
- 자원 효율성, 클러스터의 각 노드에서 2MB메모리 1mili core의 CPU만 필요로함
- 5,000 노드 클러스터를 지원한다. 

## 사용 케이스

- CPU/Memory 기반의 수평 확장을 위한 기본 정보가 됨 (수평 오토 스케일링)
- 자동으로 리소스를 adjusting/suggesting 한다. (수직 오토 스케일링)

## 비추천 사용 케이스 

- Non Kubernetes cluster 에는 사용하지 않기
- 리소스 사용 메트릭의 원천의 정확성이 필요할때
- CPU/Memory가 아닌 다른 지표로 수평 스케일링을 하고자 할때.

## Install

메트릭 서버를 다음과 같이 설치한다. 

```shell
kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
```

metrics-server 가 정상 설치 되었는지 검증한다. 

```shell
kubectl get deployment metrics-server -n kube-system
```


